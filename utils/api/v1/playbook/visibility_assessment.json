{
  "stagename": "assessment/visibility-",
  "header-comment": "*****************************************************************************************************************************************************\n*                                                                                                                                                   *\n*  This script makes all of the required changes to add 'Visibility' to your PAN-OS XML configuration file.                                         *\n*             (To achieve ‘Visibility’ the script can be used 'as is' without any changes).                                                         *\n*                                                                                                                                                   *\n*  This script will need you to only do the following two things;                                                                                   *\n*    i) Rename the input file referenced in the first pan-os-php command below to be the XML configuration file being used (eg: example_panos.xml). *\n*    ii) Copy the input file from the above (ie: example_panos.xml) to the pan-os-php staging directory so that it can be referenced by this script.*\n*                                                                                                                                                   *\n*****************************************************************************************************************************************************\n\n*****************************************************************************************************************************************************\n*                                                                                                                                                   *\n*  The script will now begin and will run a sequence of pan-os-php commands.                                                                        *\n*  Each new command will use the outputfile of the previous command as the input file of the new command.                                           *\n*  The final xml file generated by the last command in this script should then be imported, and then loaded into the PAN-OS firewall.               *\n*                                                                                                                                                   *\n*****************************************************************************************************************************************************",
  "footer-comment": "*****************************************************************************************************************************************************\n*                                                                                                                                                   *\n*   VISIBILITY playbook FINALISED                                                                                                                   *\n*                                                                                                                                                   *\n*****************************************************************************************************************************************************",
  "command": [
    {
      "type": "zone",
      "actions": "actions=exportToExcel:1a_NoZPP_UsedinZone.html",
      "filter": "filter=!(zpp is.set)",
      "location": "location=any"
    },
    {
      "type": "zone",
      "actions": "actions=exportToExcel:1b_NoLFP_UsedinZone.html",
      "filter": "filter=!(logprof is.set)",
      "location": "location=any"
    },
    {
      "type": "rule",
      "actions": "actions=exportToExcel:2_NoLFP_UsedinRule.html",
      "filter": "filter=!(logprof is.set)",
      "location": "location=any"
    },
    {
      "type": "rule",
      "actions": "actions=exportToExcel:3_NoSPG_in_AllowRule.html",
      "filter": "filter=!(secprof is.set) and (action is.allow)",
      "location": "location=any"
    },
    {
      "type": "rule",
      "actions": "actions=exportToExcel:4a_NoVP_in_AllowRule.html",
      "filter": "filter=(secprof type.is.profile) and !(secprof vuln-profile.is.set) and (action is.allow)",
      "location": "location=any"
    },
    {
      "type": "rule",
      "actions": "actions=exportToExcel:4b_NoAS_in_AllowRule.html",
      "filter": "filter=(secprof type.is.profile) and !(secprof as-profile.is.set) and (action is.allow)",
      "location": "location=any"
    },
    {
      "type": "rule",
      "actions": "actions=exportToExcel:4c_NoAV_in_AllowRule.html",
      "filter": "filter=(secprof type.is.profile) and !(secprof av-profile.is.set) and (action is.allow)",
      "location": "location=any"
    },
    {
      "type": "rule",
      "actions": "actions=exportToExcel:4d_NoURL_in_AllowRule.html",
      "filter": "filter=(secprof type.is.profile) and !(secprof url-profile.is.set) and (action is.allow)",
      "location": "location=any"
    },
    {
      "type": "rule",
      "actions": "actions=exportToExcel:4e_NoFB_in_AllowRule.html",
      "filter": "filter=(secprof type.is.profile) and !(secprof file-profile.is.set) and (action is.allow)",
      "location": "location=any"
    },
    {
      "type": "rule",
      "actions": "actions=exportToExcel:4f_NoWF_in_AllowRule.html",
      "filter": "filter=(secprof type.is.profile) and !(secprof wf-profile.is.set) and (action is.allow)",
      "location": "location=any"
    },
    {
      "type": "securityprofilegroup",
      "actions": "actions=exportToExcel:5a_NoAV_Exists_in_SPG.html",
      "filter": "filter=!(secprof av-profile.is.set )",
      "location": "location=any"
    },
    {
      "type": "securityprofilegroup",
      "actions": "actions=exportToExcel:5b_NoVP_Exists_in_SPG.html",
      "filter": "filter=!(secprof vuln-profile.is.set )",
      "location": "location=any"
    },
    {
      "type": "securityprofilegroup",
      "actions": "actions=exportToExcel:5c_NoURL_Exists_in_SPG.html",
      "filter": "filter=!(secprof url-profile.is.set )",
      "location": "location=any"
    },
    {
      "type": "securityprofilegroup",
      "actions": "actions=exportToExcel:5d_NoFB_Exists_in_SPG.html",
      "filter": "filter=!(secprof file-profile.is.set )",
      "location": "location=any"
    },
    {
      "type": "securityprofilegroup",
      "actions": "actions=exportToExcel:5e_NoAS_Exists_in_SPG.html",
      "filter": "filter=!(secprof as-profile.is.set )",
      "location": "location=any"
    },
    {
      "type": "securityprofilegroup",
      "actions": "actions=exportToExcel:5f_NoWF_Exists_in_SPG.html",
      "filter": "filter=!(secprof wf-profile.is.set )",
      "location": "location=any"
    },
    {
      "type": "rule",
      "actions": "actions=exportToExcel:6_SPG_exists_in_DenyRule.html",
      "filter": "filter=(secprof is.set) and !(action is.allow)",
      "location": "location=any"
    },
    {
      "type": "rule",
      "actions": "actions=exportToExcel:7_Log-at-End_Missing_inRule.html",
      "filter": "filter=!(log at.end)",
      "location": "location=any"
    },
    {
      "type": "rule",
      "ruletype": "ruletype=defaultsecurity",
      "actions": "actions=exportToExcel:8a_DefaultSec_NoLog-at-End.html",
      "filter": "filter=!(log at.end)",
      "location": "location=any"
    },
    {
      "type": "rule",
      "ruletype": "ruletype=defaultsecurity",
      "actions": "actions=exportToExcel:8b_DefaultSec_No_LFP.html",
      "filter": "filter=!(logprof is.set)",
      "location": "location=any"
    },
    {
      "type": "rule",
      "ruletype": "ruletype=defaultsecurity",
      "actions": "actions=exportToExcel:8c_DefaultSec_No_SPG-inAllow.html",
      "filter": "filter=!(secprof is.set) and (action is.allow)",
      "location": "location=any"
    },
    {
      "type": "rule",
      "ruletype": "ruletype=defaultsecurity",
      "actions": "actions=exportToExcel:8d_DefaultSec_SPG-inDeny.html",
      "filter": "filter=(secprof is.set) and !(action is.allow)",
      "location": "location=any"
    },
    {
      "comment": "merge all previously created html files into one Excel sheet",
      "type": "html-merger",
      "adddefaulthtml": "adddefaulthtml",
      "exportCSV": "exportCSV=visability_assessment.xlsx"
    }    
  ]
}